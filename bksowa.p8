pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
function _init()
  //screen state
  screen = 1  // game title
  //10 = gameplay
  //99 = game over

		//player
  p = {}
  p.x = 16 //position x
  p.y = 64 //position y
  p.vx = 0 //velocity x
  p.vy = 0 //velocity y
  p.sprites = {}
  p.sprites[1] = 64
  p.sprites[2] = 66
  p.sprites[3] = 68
  p.cframe = 1 //current frame
  p.tslfc = 0 //last frame change
  p.state = "running" //running, jump1, jump2
  
  //camera position
  cx=0
  
  //camera velocity
  cvx=2
  
  //draw time elapsed
  t=0
end

function _update()
  if screen == 1 then
    if btn() > 0 then
      screen = 10
    end  
  end

  if screen == 10 then
		  if btnp(2) then
		    if p.state == "running" then
		      p.state = "jump1"
		      p.vy = -6
		    elseif p.state == "jump1" then
		      p.state = "jump2"
		      p.vy = -6
		    end
		  elseif grounded() then
		    p.vy = 0
		    p.y = flr(flr(p.y)/8)*8
		    p.state = "running"
		  else
		    p.vy += 0.55
		  end
		  
		  p.x += min(p.vx, 2)
		  p.y += min(p.vy, 5)	
  end
end

function _draw()
  cls()
  t+=1
  
  if screen == 1 then
    drawtitlescreen()
  end
  
  if screen == 10 then
    rectfill(0,0,1050,128,1) //sky
    circfill(cx,0,15,10) //sun
		  map(0, 0, 0, 0, 128, 16)  
		  p.x += cvx
		  ani(p, 2, 2, 3, 4)
  
    cx += cvx
    if cx > 900 then
      cx = 0
    		p.x = 16
  		end
  		camera(cx, 0)
  end
end

function ani(n,w,h,frames,speed)
  if n.tslfc > speed then
    n.cframe+=1
    if n.cframe > rawlen(n.sprites) then
      n.cframe=1
    end 
    n.tslfc=0
  end
  spr(n.sprites[n.cframe], n.x, n.y, w, h)
  n.tslfc+=1
end

function grounded()
  local v = mget(flr(p.x + 8) / 8, flr(p.y + 16) / 8)
  return fget(v, 0)
end

function drawtitlescreen()
		spr(129, 32, 16, 64, 64)
	 color(13)
	 print("press any button to start", 12, 64)
end
__gfx__
000000000000009999000000b3b3b3b30000033b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000096960000003bbb3bbb000000b40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000090499909000044544544000000030000000000000000000000000000003333000000000000000000000000000000000000000000000000000000
000770000000b044440b0000444404040000000000000000000000000000000000300333b3300000000000000000000000000000000000000000000000000000
000770000000bb0bb0bb000004000400000000000000000000000000000000000333393333330000000000000000000000000000000000000000000000000000
0070070000000bbbbbb0000000000000000000000000000000000000000000000033333338390000000000000000000000000000000000000000000000000000
00000000000000bbbb000000000000000000000000000000000000000000000000333b333b333000000000000000000000000000000000000000000000000000
000000000000000bb000000000000000000000000000000000000000000000000003833b33333300000000000000000000000000000000000000000000000000
00000000000000088000000033b3b333000004b30000000000000000000000000000333333008000000000000000000000000000000000000000000000000000
000000000000008888000000b33b33b3000004330000000000000000000000000000040444004000000000000000000000000000000000000000000000000000
0000000000000880088000004443443b000003b40000000000000000000000000000040440004000000000000000000000000000000000000000000000000000
00000000000008800880000000044333000004330000000000000000000000033000004440440000000000000000000000000000000000000000000000000000
000000000000080000800000000044b3000004b30000000000000000000000383390000444000000000000000000000000000000000000000000000000000000
00000000000099000099000000003433000004430000000000000000000000333333000440000003330000000000000000000000000000000000000000000000
000000000000000000000000000004bb00000b33000000000000000000000033b834000440000033830000000000000000000000000000000000000000000000
000000000000000000000000000004330000043b0000000000000000000030033334400440000039330000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000033003330044440000044330000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000383330000000440000440000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000033b330000000440444000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000333390000000444400000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000333334000000444000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003393304400000440000000030b00000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000044000440000000333000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000004440440000000938300000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000044440000000033300000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000440000004430000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000440000044000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000440000444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000444444004400000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000440000000000000000000000000000000000000000000000000000000
000000fff00000000000000000000000000000000000000000000000000000000000000440000000000000000000000000000000000000000000000000000000
000000ffc00000000000000000000000000000000000000000000000000000000000000440000000000000000000000000000000000000000000000000000000
00000009999000000000000999900000000000099990000000000000000000000000000440000000000000000000000000000000000000000000000000000000
0000000f3f0000000000000f3f0000000000000f3f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000004ff00000000000004ff00000000000004ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000004440000000000000444000000000000044400000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000ff00000000000000ff00000000000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000999999000000000099999900000000009999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00009099990900000000909999900000000009999909000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000909999090000000090999990000000000999990099f000000000000000000000000000000000000000000000000000000000000000000000000000000000
000900999909000000009099999000000000009f9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000f0099990f00000000f09999f00000000000999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000055550000000000005555000000000000555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000050050000000000005005000000000000500050000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000050050000000000005005000000000000500005000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000050050000000004550005000000000000500005000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000040044000000004000004000000000000440004400000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000040000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000333000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000003303300000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000003003000000330000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000003003300033000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999999000009900000090000eeeeeeeeee03300303330000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999009990009900000990000eeeeeeeeee00333303000003300000000000000000000000000000000000000000000000000000000000000000000
00000000000999000099009900009900000eeeeeeeeee00000003000330000000000000000000000000000000000000000000000000000000000000000000000
00000000000999000009009900099000000000eee00000eeeee03333300333000000000000000000000000000000000000000000000000000000000000000000
00000000000999000009009900990008880000eee0e000ee00000000003303000000000000000000000000000000000000000000000000000000000000000000
00000000000999000009009909900088080000eee0e0000eeeee0033333003000000000000000000000000000000000000000000000000000000000000000000
00000000000999000009009999000080080000eee0eeee00eeee0000033003000000000000000000000000000000000000000000000000000000000000000000
00000000000999000009009990000080880000eee0ee0ee0e0000000003003000000000000000000000000000000000000000000000000000000000000000000
00000000000999000099009990000088800000eee0e000e0eeee0000000333000000000000000000000000000000000000000000000000000000000000000000
00000000000999000990009990000088800800000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999999900009990000880888800000000000000000033333333000000000000000000000000000000000000000000000000000000000000000000
00000000000999999000009999000800008800aaa000000aaaaa0030030003000000000000000000000000000000000000000000000000000000000000000000
0000000000099900099000990990088008808aa0aa0aaa0a00000030030003000000000000000000000000000000000000000000000000000000000000000000
0000000000099900009000990099008888000a000a0a0a0aa0000000030003000000000000000000000000000000000000000000000000000000000000000000
0000000000099900009000990009900000000aaaaa0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999000090009900009900000000000000000aaaaa0033333333000000000000000000000000000000000000000000000000000000000000000000
000000000009990000900099000009900000000000a0000000000000033003000000000000000000000000000000000000000000000000000000000000000000
00000000000999000090009900000099000a000a00a0000000000003333003000000000000000000000000000000000000000000000000000000000000000000
00000000000999000990009900000009900a0a0a00aaa0aaa0aaa033003330000000000000000000000000000000000000000000000000000000000000000000
00000000000999009900009900000009900a0aaa00a0a0a000a00000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000099999900000990c000009900aaaaa00a0a0aaa0aaa0a0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000cccc0000000000000a000a000a000a0000000000000000000000000000000000000000000000000000000000000000000000000
00000000000ccccc000c00000c00000000000c00000000aaa0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000
00000000000c000c000c0c0c0ccc00cccc0cccc0c0c0000000aaa0aaaaaaa0000000000000000000000000000000000000000000000000000000000000000000
00000000000ccccc0ccc0c0c0c0000c00c000c00c0c0cc0cc0000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000c000c0ccc00c00cccc0c00c000c00ccc0c00cc0000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000100000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000708090a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000001718191a0000000000000000000000000000000000000000000000000000000000000000030000000000000000000708090a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000002728292a0000000000000000000000000000000000000000000000000000000000000000000708090a00000000001718191a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000003738393a0000000000000000000000000000000000000000000000000000000000000003031718191a00000000002728292a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000030303000000000000000000000708090a030000000000000000000000000000000000002728292a00000000003738393a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000001718191a000000000000000000000000000000000000003738393a0000000003030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000002728292a00000000000000000000000000000000030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000003738393a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000708090a0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000003030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001718191a0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000030313000708090a00000000000000000000000000000000000000000000000000000000000000030300000000000000000000000000000000000000000000000000000000002728292a0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000003030303001718191a0000000000000000000000000000000000000708090a00000000000000000000000000000000000003030303000708090a140303030303030303130000003738393a0000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000002728292a0000000000000000000000000000000000001718191a00000000000000000000000000000000000000000000001718191a14000000000000000004030303030303030303030303030313000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000003738393a0000000000000000030303030303130000002728292a03030303030303030303030313000000000000000000002728292a14000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303030303030303031300000000000014000000000000140000003738393a03000000000000000000000014000000000000000000003738393a14000000000000000000000000000000000000000000000004030303030303030303030303030303030303030303030303030303
0000000000000000000000000000000000000000000000000000000403030303030303000000000000040303030303030303000000000000000000000004030303030303030303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
